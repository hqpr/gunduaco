{% extends 'base.html' %}
{% block title %} Search results {% endblock %}
{% block content %}

    {% if errors %}
        {% for error in errors %}
            <div class="alert alert-danger">{{ error }}</div>
        {% endfor %}
    {% endif %}

    <p>Search query
        <strong>
            {% if not query %}
                Dates: {{ s }} - {{ e }}
            {% else %}
                {{ query }}
            {% endif %}
        </strong></p>

    {% if product %}
        <div class="alert alert-success"><p>Found <b>{{ product|length }}</b>:</div>
        {% for p in product %}
            <a href="/product/{{ p.id }}">{{ p.name }}</a> <br/>
        {% endfor %}
    {% elif result %}
        <div class="alert alert-success"><p>Found <b>{{ result|length }}</b> products with promotion>0: </div>
        <div class="col-md-4 pull-left">
            <form action="{% url 'products.views.custom' %}" role="form" method="post">
                {% csrf_token %}
                {% for res in result %}
                    <div class="checkbox">
                        <label><input type="checkbox" value="{{ res.product_id }}" name="product_id">{{ res.product }}</label>
                        <input type="hidden" value="{{ s }}" name="valid_from"/>
                        <input type="hidden" value="{{ e }}" name="valid_to"/>
                    </div>
                {% endfor %}

        </div>
    {% else %}
        <div class="alert alert-danger">Nothing found with promotions > 0</div>
    {% endif %}
    <hr/>


    <div class="col-md-8">
        <label for="category" class="control-label input-group">Category</label>
        <div class="btn-group" data-toggle="buttons">
            {% for r in result %}
                <label class="btn btn-default">
                    <input type="radio" name="category_id" value="{{ r.product.category_id }}">{{ r.product.category }}
                </label>
            {% endfor %}
        </div>

        <hr/>
        <label for="subcategory" class="control-label input-group">Sub-Category</label>
        <div class="btn-group" data-toggle="buttons">
            {% for r in result %}
                <label class="btn btn-default">
                    <input type="radio" name="subcategory_id" value="{{ r.product.subcategory_id }}">{{ r.product.subcategory }}
                </label>
            {% endfor %}
        </div>

        <hr/>
        <label for="subcategory" class="control-label input-group">Sub-Sub-Category</label>
        <div class="btn-group" data-toggle="buttons">
            {% for r in result %}
                <label class="btn btn-default">
                    {% if r.product.subsubcategory %}
                        <input type="radio" name="subsubcategory_id" value="{{ r.product.subsubcategory_id }}">{{ r.product.subsubcategory }}
                    {% endif %}
                </label>
            {% endfor %}
        </div>

        <label for="year" class="control-label input-group">Brand</label>
        <div class="btn-group" data-toggle="buttons">
            {% for r in result %}
                <label class="btn btn-default">
                    <input type="radio" name="brand_id" value="{{ r.product.brand_id }}">{{ r.product.brand }}
                </label>
            {% endfor %}
        </div>

        <hr/>
        <button type="submit" class="btn btn-default btn-lg">
            <span class="glyphicon glyphicon-signal"></span> Build chart
        </button>
        </form>
    </div>



    {#    {% if result.has_previous %}#}
    {#        <a href="%?page={{ result.previous_page_number }}"> &larr; </a>#}
    {#    {% endif %}#}
    {#    <ul class="pagination">#}
    {#            <li><a href="">{{ result.number }}</a></li>#}
    {#    {% if result.has_next %}#}
    {#            <li><a href="&amp;?page={{ result.next_page_number }}">{{ result.next_page_number }}</a></li>#}
    {#            <li><a href="&amp;?page={{ result.paginator.num_pages }}">{{ result.paginator.num_pages }}</a></li>#}
    {#            <li><a href="&amp;?page={{ result.next_page_number }}" title="Next page">&rarr; </a></li>#}
    {#        </ul>#}
    {#    {% endif %}#}

{% endblock %}